# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: chat.rules,v 1.55.4.6.4.3 2010/09/27 16:44:53 vrtbuild Exp $
#-------------
# CHAT RULES
#-------------
# These signatures look for people using various types of chat programs (for
# example: AIM, ICQ, and IRC) which may be against corporate policy

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT ICQ access"; flow:to_server,established; content:"User-Agent|3A|ICQ"; metadata:policy security-ips drop; classtype:policy-violation; sid:541; rev:10;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"CHAT ICQ forced user addition"; flow:established,to_client; content:"Content-Type|3A| application/x-icq"; fast_pattern:only; content:"[ICQ User]"; reference:bugtraq,3226; reference:cve,2001-1305; classtype:policy-violation; sid:1832; rev:11;)

alert tcp $HOME_NET any <> $EXTERNAL_NET 1863 (msg:"CHAT MSN message"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A|"; nocase; content:"text/plain"; distance:1; metadata:policy security-ips drop; classtype:policy-violation; sid:540; rev:12;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1863 (msg:"CHAT MSN outbound file transfer request"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A| application/x-msnmsgrp2p"; nocase; content:"INVITE"; distance:0; nocase; metadata:policy security-ips drop; classtype:policy-violation; sid:1986; rev:7;)
alert tcp $EXTERNAL_NET 1863 -> $HOME_NET any (msg:"CHAT MSN outbound file transfer accept"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A| application/x-msnmsgrp2p"; distance:0; nocase; content:"MSNSLP/1.0 200 OK"; distance:0; nocase; metadata:policy security-ips drop; classtype:policy-violation; sid:1988; rev:6;)
alert tcp $EXTERNAL_NET 1863 -> $HOME_NET any (msg:"CHAT MSN outbound file transfer rejected"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A| application/x-msnmsgrp2p"; distance:0; nocase; content:"MSNSLP/1.0 603 Decline"; distance:0; nocase; metadata:policy security-ips drop; classtype:policy-violation; sid:1989; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1863 (msg:"CHAT MSN user search"; flow:to_server,established; content:"CAL "; depth:4; nocase; metadata:policy security-ips drop; classtype:policy-violation; sid:1990; rev:2;)

alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC nick change"; flow:to_server,established; content:"NICK "; fast_pattern:only; pcre:"/^\s*NICK/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:542; rev:14;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC DCC file transfer request"; flow:to_server,established; content:"PRIVMSG "; nocase; content:" |3A|.DCC SEND"; distance:0; nocase; pcre:"/^\s*PRIVMSG/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:1639; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC DCC chat request"; flow:to_server,established; content:"PRIVMSG "; nocase; content:" |3A|.DCC CHAT chat"; distance:0; nocase; pcre:"/^\s*PRIVMSG/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:1640; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC channel join"; flow:to_server,established; content:"JOIN "; fast_pattern:only; pcre:"/^\s*JOIN/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:1729; rev:8;)
alert tcp $HOME_NET any <> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC message"; flow:established; content:"PRIVMSG "; fast_pattern:only; pcre:"/^\s*PRIVMSG/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:1463; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC dns request"; flow:to_server,established; content:"USERHOST "; fast_pattern:only; pcre:"/^\s*USERHOST/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:1789; rev:6;)
alert tcp $EXTERNAL_NET 6666:7000 -> $HOME_NET any (msg:"CHAT IRC dns response"; flow:to_client,established; content:"|3A|"; offset:0; content:" 302 "; content:"=+"; fast_pattern:only; metadata:policy security-ips drop; classtype:policy-violation; sid:1790; rev:6;)

# alert tcp $HOME_NET any -> $AIM_SERVERS any (msg:"CHAT AIM login"; flow:to_server,established; content:"*|02|"; depth:2; content:"|00 17 00 06|"; within:8; distance:4; metadata:policy security-ips drop; classtype:policy-violation; sid:1631; rev:10;)
# alert tcp $AIM_SERVERS any -> $HOME_NET any (msg:"CHAT AIM receive message"; flow:to_client; content:"*|02|"; depth:2; content:"|00 04 00 07|"; depth:4; offset:6; metadata:policy security-ips drop; classtype:policy-violation; sid:1633; rev:8;)



alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM successful logon"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 01|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2450; rev:4;)
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM voicechat"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00|J"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2451; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo IM ping"; flow:to_server,established; content:"YMSG"; depth:4; nocase; content:"|00 12|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2452; rev:5;)

alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM conference invitation"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 18|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2453; rev:4;)
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM conference logon success"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 19|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2454; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo IM conference message"; flow:to_server,established; content:"YMSG"; depth:4; nocase; content:"|00 1D|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2455; rev:4;)

alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo Messenger File Transfer Receive Request"; flow:established; content:"YMSG"; depth:4; content:"|00|M"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2456; rev:5;)
alert tcp any any <> any 5101 (msg:"CHAT Yahoo IM message"; flow:established; content:"YMSG"; depth:4; nocase; metadata:policy security-ips drop; classtype:policy-violation; sid:2457; rev:3;)

alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM successful chat join"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 98|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2458; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo IM conference offer invitation"; flow:to_server,established; content:"YMSG"; depth:4; nocase; content:"|00|P"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:2459; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5100 (msg:"CHAT Yahoo IM conference request"; flow:to_server,established; content:"<R"; depth:2; pcre:"/^\x3c(REQIMG|RVWCFG)\x3e/ism"; metadata:policy security-ips drop; classtype:policy-violation; sid:2460; rev:5;)
alert tcp $EXTERNAL_NET 5100 -> $HOME_NET any (msg:"CHAT Yahoo IM conference watch"; flow:from_server,established; content:"|0D 00 05 00|"; depth:4; metadata:policy security-ips drop; classtype:policy-violation; sid:2461; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"CHAT Yahoo Messenger File Transfer Initiation Request"; flow:established; content:"/notifyft"; depth:14; nocase; content:"Host|3A| filetransfer.msg.yahoo.com"; nocase; metadata:policy security-ips drop; classtype:policy-violation; sid:3692; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo Messenger Message"; flow:established; content:"YMSG"; depth:4; content:"|00 06|"; depth:2; offset:10; metadata:policy security-ips drop; classtype:policy-violation; sid:3691; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC channel notice"; flow:to_server,established; content:"NOTICE "; fast_pattern:only; pcre:"/^\s*NOTICE/smi"; metadata:policy security-ips drop; classtype:policy-violation; sid:6182; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT jabber file transfer request"; flow:established,to_server; content:"xmlns="; nocase; content:"jabber.org/protocol"; distance:0; nocase; content:"file-transfer"; distance:0; nocase; metadata:policy security-ips drop; reference:url,www.jabber.org/jeps/jep-0096.html; reference:url,www.xmpp.org; classtype:policy-violation; sid:6468; rev:2;)
# alert udp any 1025: -> any 1025: (msg:"CHAT Microsoft Live chat video feed initiation"; content:"H|00 00 00 00 00 00 00 00 00|"; fast_pattern:only; dsize:10; reference:url,ml20rc.msnfanatic.com/vc_1_1/; classtype:policy-violation; sid:12457; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"CHAT ebuddy.com login attempt"; flow:established,to_client; content:"Set-Cookie|3A| network="; nocase; http_header; content:"Domain=.ebuddy.com"; fast_pattern:only; reference:url,www.ebuddy.com; classtype:policy-violation; sid:12611; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT jabber traffic detected"; flow:established,to_server; content:"jabber|3A|client"; fast_pattern:only; threshold:type limit,track by_src,count 1,seconds 60; metadata:policy security-ips alert; reference:url,www.xmpp.org; classtype:policy-violation; sid:6467; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 1863 (msg:"CHAT MSN login attempt"; flow:to_server,established; content:"USR "; depth:4; nocase; content:" TWN "; distance:1; nocase; threshold:type limit, track by_src, count 1, seconds 60; metadata:policy security-ips alert; classtype:policy-violation; sid:1991; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server setup Authentication bypass attempt"; flow:to_server,established; content:"setup/setup-"; fast_pattern:only; pcre:"/^[A-Z]+\s+\x2Fsetup\x2Fsetup-.*?\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; reference:cve,2008-6509; classtype:attempted-admin; sid:15153; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server logout Authentication bypass attempt"; flow:to_server,established; content:"index.jsp?logout=true"; fast_pattern:only; pcre:"/^[a-zA-Z]+\s+\x2Findex\x2Ejsp\x3Flogout\x3Dtrue.*\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; classtype:attempted-admin; sid:15151; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server gif Authentication bypass attempt"; flow:to_server,established; content:".gif"; fast_pattern:only; pcre:"/^[a-zA-Z]+\s+\x2F\x2Egif.*\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; classtype:attempted-admin; sid:15154; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server serverdown Authentication bypass attempt"; flow:to_server,established; content:"error-serverdown.jsp"; fast_pattern:only; pcre:"/^[a-zA-Z]+\s+\x2Ferror-serverdown\x2Ejsp.*\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; classtype:attempted-admin; sid:15156; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server setup-index Authentication bypass attempt"; flow:to_server,established; content:"setup/index.jsp"; fast_pattern:only; pcre:"/^[a-zA-Z]+\s+\x2Fsetup\x2F\index\x2Ejsp.*\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; classtype:attempted-admin; sid:15152; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server login Authentication bypass attempt"; flow:to_server,established; content:"login.jsp"; fast_pattern:only; pcre:"/^[a-zA-Z]+\s+\x2Flogin\x2Ejsp.*\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; classtype:attempted-admin; sid:15150; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,9091] (msg:"CHAT Jive Software Openfire Jabber Server png Authentication bypass attempt"; flow:to_server,established; content:".png"; fast_pattern:only; pcre:"/^[a-zA-Z]+\s+\x2F\x2Epng.*\x2E\x2E\x2F/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32189; classtype:attempted-admin; sid:15155; rev:2;)
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo messenger http link transmission attempt"; flow:to_client,established; content:"YMSG"; depth:4; content:"|00 06|"; within:2; distance:6; content:"http|3A|//"; distance:0; pcre:"/http\x3A\x2F\x2F[^\s]/"; metadata:policy security-ips drop; reference:url,en.wikipedia.org/wiki/Yahoo!_Messenger#Malware; classtype:trojan-activity; sid:15183; rev:2;)
alert tcp $EXTERNAL_NET 1863 -> $HOME_NET any (msg:"CHAT MSN messenger http link transmission attempt"; flow:to_client,established; content:"MSG"; depth:3; content:"http|3A|//"; distance:0; pcre:"/http\x3A\x2F\x2F[^\s]/"; metadata:policy security-ips drop; reference:url,en.wikipedia.org/wiki/MSN_Messenger#Malware; classtype:trojan-activity; sid:15184; rev:1;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 8000 (msg:"CHAT QQ protocol detected - version 2006"; content:"|02 0E|5|00|"; depth:4; threshold:type limit, track by_src, count 1, seconds 300; metadata:policy security-ips alert; reference:url,www.qq.com; classtype:policy-violation; sid:15292; rev:1;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 8000 (msg:"CHAT QQ protocol detected - version 2008"; content:"|02 12|Q|00|"; depth:4; threshold:type limit, track by_src, count 1, seconds 300; metadata:policy security-ips alert; reference:url,www.qq.com; classtype:policy-violation; sid:15293; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"CHAT AIM server certificate for encrypted login"; flow:established,to_client; ssl_version:tls1.0; content:"0|16 06 03|U|04 03 13 0F|kdc.uas.aol.com"; fast_pattern:only; classtype:policy-violation; sid:15418; rev:4;)
alert tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"CHAT Cerulean Studios Trillian image filename handling XML tag overflow attempt"; flow:to_client,established; content:"*|02|"; depth:2; content:"|00 04 00 07|"; within:4; distance:4; content:"<IMG "; nocase; pcre:"/\x3cimg[^\x3e]*src\x3d(\x22|\x27)?[^\x22\x27\s]{300}/i"; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2008-5401; classtype:attempted-user; sid:15489; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"CHAT Yahoo encrypted login attempt"; flow:to_client,established; ssl_version:tls1.0; content:"login.yahoo.com"; fast_pattern:only; metadata:service ssl; classtype:policy-violation; sid:15569; rev:5;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"CHAT AIM encrypted login attempt"; flow:to_client,established; ssl_version:tls1.0; content:"kdc.uas.aol.com"; fast_pattern:only; metadata:service ssl; classtype:policy-violation; sid:15568; rev:4;)
alert tcp $EXTERNAL_NET 6666:7000 -> $HOME_NET any (msg:"CHAT mIRC PRIVMSG message processing overflow attempt"; flow:to_client,established; isdataat:317; content:"PRIVMSG"; fast_pattern:only; pcre:"/[^\x3a\s]{309}\sPRIVMSG/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ircd; reference:bugtraq,31552; reference:cve,2008-4449; classtype:attempted-user; sid:15711; rev:2;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"CHAT deny Gmail chat DNS request"; byte_test:1,!&,128,2; content:"|0B|chatenabled|04|mail|06|google|03|com"; fast_pattern:only; classtype:policy-violation; sid:16443; rev:2;)
alert tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"CHAT Trillian AIM XML tag handling heap buffer overflow attempt"; flow:to_client, established; content:"*|02|"; depth:2; content:"|00 04 00 07|"; within:4; distance:4; isdataat:1023; pcre:"/\x2A\x02.{4}\x00\x04\x00\x07.*\x3C\x3E[^\x00]{1023,}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,32645; reference:cve,2008-5403; reference:url,dev.aol.com/aim/oscar/; classtype:attempted-user; sid:16514; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"CHAT mIRC IRC URL buffer overflow attempt"; flow:to_client,established; content:"src='irc|3A|//"; pcre:"/^\S{999}/R"; metadata:service http; reference:bugtraq,8819; reference:cve,2003-1336; classtype:attempted-user; sid:16579; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT MSN Messenger web login attempt"; flow:established,to_server; content:"/gateway/gateway.dll"; fast_pattern; nocase; http_uri; content:"Action=open"; nocase; http_uri; content:"messenger.hotmail.com"; nocase; http_uri; metadata:policy security-ips alert, service http; reference:url,webmessenger.msn.com; classtype:policy-violation; sid:16525; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Yahoo Messenger web client activity"; flow:established,to_server; content:"wmsgr.account"; fast_pattern; nocase; http_uri; content:"Host|3A| webmessenger.yahoo.com"; nocase; metadata:policy security-ips drop; reference:url,messenger.yahoo.com; classtype:policy-violation; sid:15560; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT MSN Messenger web client activity"; flow:established,to_server; content:"/session/"; nocase; http_uri; content:"webmessenger.msn.com"; fast_pattern; nocase; http_header; threshold:type limit, track by_src, count 1, seconds 300; metadata:policy security-ips alert, service http; reference:url,webmessenger.msn.com; classtype:policy-violation; sid:15577; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT AOL Aimexpress web client login"; flow:established,to_server; content:"/aim/startSession"; fast_pattern; nocase; http_uri; content:"clientName=gromit"; nocase; http_uri; metadata:policy security-ips drop; reference:url,www.aim.com/aimexpress.adp/; classtype:policy-violation; sid:15561; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT MSN Messenger web client login"; flow:established,to_server; content:"login.srf"; nocase; http_uri; content:"ru=http|3A|/webmessenger.msn.com"; fast_pattern; nocase; http_uri; metadata:policy security-ips drop, service http; reference:url,webmessenger.msn.com; classtype:policy-violation; sid:15576; rev:6;)
alert tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"CHAT Gaim AIM-ICQ Protocol Handling Buffer Overflow attempt"; flow:from_server,established; content:"|2A 02|"; depth:2; content:"|00 02 00 06|"; within:4; distance:4; content:"us-ascii|22 00 04|"; distance:0; byte_test:2,>,0x0100,0,relative; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,14531; reference:cve,2005-2103; classtype:attempted-user; sid:17357; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5004:65535 (msg:"CHAT MSN Messenger and Windows Live Messenger Code Execution attempt"; content:"|F3 49|"; depth:2; byte_test:1,>,130,5,relative,little; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,25461; reference:cve,2007-2931; classtype:attempted-user; sid:17551; rev:1;)
