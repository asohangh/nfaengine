alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY battle-mail traffic"; flow:to_server,established; content:"BattleMail"; classtype:policy-violation; sid:490; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POLICY psyBNC access"; flow:from_server,established; content:"Welcome!psyBNC@lam3rz.de"; fast_pattern:only; classtype:bad-unknown; sid:493; rev:7;)
# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: policy.rules,v 1.103.4.12.2.1.2.5 2010/09/30 16:59:46 vrtbuild Exp $
#-------------
# POLICY RULES
#-------------
#

# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP anonymous login attempt"; flow:to_server,established; content:"USER"; fast_pattern:only; pcre:"/^USER\s+(anonymous|ftp)[^\w]*[\r\n]/smi"; classtype:misc-activity; sid:553; rev:10;)

alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"POLICY WinGate telnet server response"; flow:from_server,established; content:"WinGate>"; reference:arachnids,366; reference:cve,1999-0657; classtype:misc-activity; sid:555; rev:8;)


# we have started to see multiple versions of this beyond 003.003, so we have
# expanded this signature to take that into account.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY VNC server response"; flow:established; content:"RFB 0"; depth:5; content:".0"; depth:2; offset:7; classtype:misc-activity; sid:560; rev:6;)

alert udp $EXTERNAL_NET any -> $HOME_NET 5632 (msg:"POLICY PCAnywhere server response"; content:"ST"; depth:2; reference:arachnids,239; classtype:misc-activity; sid:566; rev:6;)
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"POLICY SMTP relaying denied"; flow:established,from_server; content:"550 5.7.1"; depth:70; reference:arachnids,249; reference:url,mail-abuse.org/tsi/ar-fix.html; classtype:misc-activity; sid:567; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9100 (msg:"POLICY HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; reference:arachnids,302; reference:bugtraq,2245; classtype:misc-activity; sid:568; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9000:9002 (msg:"POLICY HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; reference:arachnids,302; reference:bugtraq,2245; classtype:misc-activity; sid:510; rev:8;)

# NOTES: This signature would be better off using uricontent, and having the
# http decoder looking at 5800 and 5802, but that is on by default
alert tcp $EXTERNAL_NET any -> $HOME_NET 5800:5802 (msg:"POLICY vncviewer Java applet download attempt"; flow:to_server,established; content:"/vncviewer.jar"; reference:nessus,10758; classtype:misc-activity; sid:1846; rev:4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP file_id.diz access possible warez site"; flow:to_server,established; content:"RETR"; nocase; content:"file_id.diz"; distance:1; nocase; classtype:suspicious-filename-detect; sid:1445; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'STOR 1MB' possible warez site"; flow:to_server,established; content:"STOR"; nocase; content:"1MB"; distance:1; nocase; classtype:misc-activity; sid:543; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'RETR 1MB' possible warez site"; flow:to_server,established; content:"RETR"; nocase; content:"1MB"; distance:1; nocase; classtype:misc-activity; sid:544; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'CWD  ' possible warez site"; flow:to_server,established; content:"CWD  "; depth:5; nocase; classtype:misc-activity; sid:546; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'MKD  ' possible warez site"; flow:to_Server,established; content:"MKD  "; depth:5; nocase; classtype:misc-activity; sid:547; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'MKD .' possible warez site"; flow:to_server,established; content:"MKD ."; depth:5; nocase; classtype:misc-activity; sid:548; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'CWD / ' possible warez site"; flow:to_server,established; content:"CWD"; nocase; content:"/ "; distance:1; classtype:misc-activity; sid:545; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'MKD / ' possible warez site"; flow:to_server,established; content:"MKD"; nocase; content:"/ "; distance:1; classtype:misc-activity; sid:554; rev:6;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 (msg:"POLICY PPTP Start Control Request attempt"; flow:to_server,established,no_stream; content:"|00 01|"; depth:2; offset:2; content:"|00 01|"; depth:2; offset:8; classtype:attempted-admin; sid:2044; rev:5;)
alert udp $EXTERNAL_NET any -> $HOME_NET 49 (msg:"POLICY xtacacs login attempt"; flow:to_server; content:"|80 01|"; depth:2; content:"|00|"; distance:4; classtype:misc-activity; sid:2040; rev:4;)
alert udp $HOME_NET 49 -> $EXTERNAL_NET any (msg:"POLICY xtacacs accepted login response"; flow:to_client; content:"|80 02|"; depth:2; content:"|01|"; distance:4; classtype:misc-activity; sid:2042; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"POLICY IPSec PGPNet connection attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 10 02 00 00 00 00 00 00 00 00 88 0D 00 00 5C 00 00 00 01 00 00 00 01 00 00 00|P|01 01 00 02 03 00 00 24 01 01 00 00 80 01 00 06 80 02 00 02 80 03 00 03 80 04 00 05 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 24 02 01 00 00 80 01 00 05 80 02 00 01 80 03 00 03 80 04 00 02 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 10|"; fast_pattern:only; classtype:protocol-command-decode; sid:1771; rev:8;)
alert udp any any -> 255.255.255.255 23945 (msg:"POLICY Data Rescue IDA Pro startup license check attempt"; flow:to_server; content:"IDA|00 01 00 00 00|"; depth:8; dsize:40; classtype:policy-violation; sid:3628; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POLICY AOL Instant Messenger Message Send"; flow:to_server,established; content:"*|02|"; depth:2; content:"|00 04 00 06|"; within:8; distance:4; byte_jump:1,16,relative; content:"|00 02|"; within:2; classtype:policy-violation; sid:3825; rev:2;)
alert tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"POLICY AOL Instant Messenger Message Receive"; flow:from_server,established; content:"*|02|"; depth:2; content:"|00 04 00 07|"; within:8; distance:4; byte_jump:1,16,relative; byte_jump:2,6,relative; byte_jump:2,2,relative; byte_jump:2,2,relative; byte_jump:2,2,relative; content:"|00 02|"; within:2; classtype:policy-violation; sid:3826; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"POLICY RDP attempted administrator connection request"; flow:to_server,established; content:"|E0|"; depth:1; offset:5; content:"mstshash"; distance:0; nocase; content:"Administr"; distance:0; nocase; pcre:"/mstshash\s*\x3d\s*Administr/smi"; reference:bugtraq,14259; reference:cve,2005-1218; reference:url,www.microsoft.com/technet/security/bulletin/MS05-041.mspx; classtype:misc-activity; sid:4060; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY HTML File upload attempt"; flow:to_server,established; content:"Content-Disposition"; nocase; content:"filename"; fast_pattern:only; nocase; reference:url,www.faqs.org/rfcs/rfc1867.html; classtype:misc-activity; sid:5708; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 5060 (msg:"POLICY Gizmo register VOIP state"; content:"INVITE sip|3A|"; nocase; content:"User-Agent|3A|"; nocase; content:"Gizmo"; fast_pattern:only; pcre:"/^User-Agent\x3A[^\n\r]+Gizmo/smi"; reference:url,www.gizmoproject.com; classtype:policy-violation; sid:6407; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY webshots desktop traffic"; flow:to_server,established; content:"User-Agent|3A|"; nocase; http_header; content:"WebshotsNetClient"; fast_pattern:only; pcre:"/User-Agent\x3A[^\n\r]+WebshotsNetClient/smiH"; threshold:type limit,track by_src,count 1,seconds 60; reference:url,www.webshots.com; classtype:misc-activity; sid:6408; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8200 (msg:"POLICY GoToMyPC startup"; flow:to_server,established; content:"ercbroker.servlets.PingServlet"; nocase; reference:url,www.gotomypc.com/howItWorks.tmpl; classtype:policy-violation; sid:7032; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8200 (msg:"POLICY GoToMyPC local service running"; flow:to_server,established; content:"jedi request"; fast_pattern:only; threshold:type limit, track by_src, count 1, seconds 60; reference:url,www.gotomypc.com/howItWorks.tmpl; classtype:policy-violation; sid:7033; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 706 (msg:"POLICY silc client outbound connection attempt"; flow:to_server,established; content:"SILC"; pcre:"/SILC\x2d\d\x2e\d/smi"; reference:url,silcnet.org/docs/draft-riikonen-silc-spec-08.txt; classtype:policy-violation; sid:7031; rev:1;)
alert tcp $EXTERNAL_NET 706 -> $HOME_NET any (msg:"POLICY silc server response attempt"; flow:to_client,established; content:"SILC"; pcre:"/SILC\x2d\d\x2e\d/smi"; content:"silc-server"; distance:0; reference:url,silcnet.org/docs/draft-riikonen-silc-spec-08.txt; classtype:policy-violation; sid:7030; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8200 (msg:"POLICY GoToMyPC remote control attempt"; flow:to_server,established; content:"jedi"; nocase; content:"request=agent"; distance:0; nocase; threshold:type limit, track by_src, count 1, seconds 60; reference:url,www.gotomypc.com/howItWorks.tmpl; classtype:policy-violation; sid:7034; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop activity"; flow:to_server,established; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; threshold:type limit, track by_src, count 1, seconds 300; classtype:policy-violation; sid:7861; rev:2;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY IPv6 encapsulated in IPv4 activity"; ip_proto:41; reference:bugtraq,29235; reference:cve,2008-2136; classtype:policy-violation; sid:8446; rev:2;)
alert tcp $EXTERNAL_NET 25999 -> $HOME_NET any (msg:"POLICY Xfire login successful"; flow:established,to_client; content:"|82|"; depth:1; offset:2; content:"userid"; depth:6; offset:6; reference:url,www.fryx.ch/xfire/protocol.html; classtype:policy-violation; sid:8484; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25999 (msg:"POLICY Xfire session initiated"; flow:established,to_server; content:"UA01"; depth:4; reference:url,www.fryx.ch/xfire/protocol.html; classtype:policy-violation; sid:8482; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25999 (msg:"POLICY Xfire login attempted"; flow:established,to_server; content:"|01|"; depth:1; offset:2; content:"name"; depth:4; offset:6; reference:url,www.fryx.ch/xfire/protocol.html; classtype:policy-violation; sid:8483; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 9030:9031 (msg:"POLICY TOR Traffic anonymizer server request"; flow:established,to_server; content:"GET /tor/server"; fast_pattern:only; classtype:policy-violation; sid:9324; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 13782 (msg:"POLICY VERITAS NetBackup system execution function call access attempt"; flow:established,to_server; content:"|00 18 00 1B 00 02|"; depth:18; reference:bugtraq,21565; reference:cve,2006-4902; reference:cve,2006-6822; classtype:misc-activity; sid:10130; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Visio file download"; flow:established,to_client; content:"Visio |28|TM|29| Drawing|0D 0A|"; fast_pattern:only; reference:url,office.microsoft.com/en-us/visio/default.aspx; classtype:policy-violation; sid:11835; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 3544 (msg:"POLICY Outbound Teredo traffic detected"; flow:to_server; content:" |01|"; depth:2; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12065; rev:2;)
alert udp $EXTERNAL_NET 3544 -> $HOME_NET any (msg:"POLICY Inbound Teredo traffic detected"; flow:to_server; content:"?|FE 83 1F|"; depth:4; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12068; rev:2;)
alert udp $EXTERNAL_NET 3544 -> $HOME_NET any (msg:"POLICY Inbound Teredo traffic detected"; flow:to_server; content:" |01|"; depth:2; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12066; rev:3;)
alert udp $HOME_NET any -> $EXTERNAL_NET 3544 (msg:"POLICY Outbound Teredo traffic detected"; flow:to_server; content:"?|FE 83 1F|"; depth:4; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12067; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Adobe FLV file transfer"; flow:established,to_client; content:"FLV|01|"; content:"|00 00 00 09|"; within:4; distance:1; flowbits:set,flv.xfer; classtype:misc-activity; sid:12182; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16800:17000 (msg:"POLICY P2PTv TVAnts TCP tracker connect traffic detected"; flow:to_server,established; flowbits:isnotset,tvant.session; content:"|04 00 07 00|"; depth:4; content:"TVANTS SHARE"; depth:12; offset:8; flowbits:set,tvant.session; classtype:policy-violation; sid:12210; rev:1;)
alert tcp $EXTERNAL_NET 16800:17000 -> $HOME_NET any (msg:"POLICY P2PTv TVAnts TCP connection traffic detected"; flow:to_client,established; flowbits:isnotset,tvant.session; content:"|04 00|"; depth:2; pcre:"/[\x01|\x02|\x03|\x04|\x05|\x06|\x07]\x00.{4}\x43\x00/R"; flowbits:set,tvant.session; classtype:policy-violation; sid:12211; rev:1;)
alert udp $HOME_NET 16800:17000 -> $EXTERNAL_NET any (msg:"POLICY P2PTv TVAnt udp traffic detected"; flowbits:isnotset,tvant.session; content:"|04 00|"; depth:2; pcre:"/[\x05|\x06|\x07]\x00.{6}[SS|DS]/R"; flowbits:set,tvant.session; classtype:policy-violation; sid:12209; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Media Player compressed skin download - .wmz"; flow:established,to_server; content:".wmz"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25305; reference:cve,2007-3037; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-047.mspx; classtype:policy-violation; sid:12278; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"POLICY Ruckus encrypted authentication connection"; flow:to_server,established; content:"|00 00|"; content:"www.ruckus.com"; within:14; distance:7; classtype:policy-violation; sid:12427; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Webmail client chat applet"; flow:established,to_server; content:"POST"; nocase; content:"/mail/channel/bind"; fast_pattern:only; classtype:policy-violation; sid:12391; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Ruckus P2P client"; flow:to_server,established; content:"User-Agent|3A| Ruckus/"; fast_pattern:only; classtype:policy-violation; sid:12425; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"POLICY Yahoo Webmail client chat applet"; flow:established,to_server; content:"<Ymsg Command="; fast_pattern:only; classtype:policy-violation; sid:12390; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Crystal reports download"; flow:to_client,established; flowbits:isset, rpt.download; content:"|D0 CF 11 E0 A1 B1 1A E1 00|"; fast_pattern:only; reference:bugtraq,21261; reference:cve,2006-6133; reference:url,www.microsoft.com/technet/security/bulletin/ms07-052.mspx; classtype:policy-violation; sid:12456; rev:3;)
alert udp $HOME_NET 5353 -> 224.0.0.251 5353 (msg:"POLICY Ruckus P2P broadcast domain probe"; flow:to_server; content:"ruckus|04|_tcp|05|local"; fast_pattern:only; classtype:policy-violation; sid:12426; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Word for Mac 5 file download"; flow:to_client,established; content:"|FE|7|00 23|"; fast_pattern:only; pcre:"/^\xfe\x37\x00\x23/m"; reference:bugtraq,25906; reference:cve,2007-3899; reference:url,www.microsoft.com/technet/security/bulletin/MS07-060.mspx; classtype:policy-violation; sid:12641; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY AIM Express Usage"; flow:to_server,established; content:"Host|3A| aimexpress.aol.com"; fast_pattern:only; reference:url,www.aim.com/aimexpress.adp; classtype:policy-violation; sid:12686; rev:2;)
# alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:"POLICY failed mysql login attempt"; flow:established,from_server; content:"|15 04|"; depth:2; offset:5; metadata:policy security-ips alert, service mysql; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13357; rev:1;)
# alert tcp $HOME_NET 21 -> $EXTERNAL_NET any (msg:"POLICY failed FTP login attempt"; flow:established,from_server; content:"530 "; depth:4; metadata:policy security-ips alert, service ftp; reference:url,www.ietf.org/rfc/rfc0959.txt; classtype:misc-activity; sid:13360; rev:1;)
# alert tcp $HOME_NET 143 -> $EXTERNAL_NET any (msg:"POLICY failed IMAP login attempt - invalid username/password"; flow:established,from_server; content:"NO LOGIN"; fast_pattern:only; pcre:"/^\s*\w+\s+NO LOGIN/smi"; metadata:policy security-ips alert, service imap; reference:url,www.ietf.org/rfc/rfc3501.txt; classtype:misc-activity; sid:13359; rev:2;)
# alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:"POLICY mysql login attempt from unauthorized location"; flow:established,from_server; content:"j|04|"; depth:2; offset:5; metadata:policy security-ips alert, service mysql; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13358; rev:1;)
# alert tcp $EXTERNAL_NET !22 -> $HOME_NET any (msg:"POLICY SSH server detected on non-standard port"; flow:established,from_server; content:"SSH-"; depth:4; nocase; pcre:"/^SSH-[12]\.\d+/smi"; reference:url,www.ietf.org/rfc/rfc4251.txt; classtype:protocol-command-decode; sid:13586; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"POLICY TOR proxy connection initiation second alternate port"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13698; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 9001:9030 (msg:"POLICY TOR proxy connection initiation"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13696; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"POLICY TOR proxy connection initiation alternate port"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13697; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Habbo chat client successful login"; flow:to_client,established; content:"document.habboLoggedIn = true"; fast_pattern:only; metadata:policy security-ips drop; reference:url,www.habbo.com; classtype:policy-violation; sid:13863; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Watson error reporting attempt"; flow:to_server,established; content:"User-Agent|3A| MSDW"; fast_pattern:only; content:"watson.microsoft.com"; content:"StageOne"; http_uri; metadata:policy security-ips drop, service http; reference:url,oca.microsoft.com/en/dcp20.asp; classtype:policy-violation; sid:13864; rev:4;)
alert tcp $EXTERNAL_NET 38101 -> $HOME_NET any (msg:"POLICY Habbo chat client avatar control"; flow:to_client,established; content:"/flatctrl useradmin/"; fast_pattern:only; metadata:policy security-ips drop; reference:url,www.habbo.com; classtype:policy-violation; sid:13861; rev:2;)
# alert tcp $HOME_NET any -> any 3689 (msg:"POLICY iTunes client login attempt"; flow:established,to_server; flowbits:isset,itunes.serverinfo.request; content:"/login"; depth:6; offset:4; nocase; reference:url,www.apple.com/itunes/; classtype:misc-activity; sid:13899; rev:4;)
# alert tcp $HOME_NET any -> any 3689 (msg:"POLICY iTunes client request for server info"; flow:established,to_server; content:"/server-info"; flowbits:set,itunes.serverinfo.request; flowbits:noalert; reference:url,www.apple.com/itunes/; classtype:misc-activity; sid:13898; rev:4;)
# alert udp $HOME_NET 5353 -> 224.0.0.251 5353 (msg:"POLICY iTunes server multicast DNS response"; content:"Library|05|_daap|04|_tcp|05|local"; fast_pattern:only; content:"|00|!"; depth:2; offset:1; content:"|0E|i"; depth:2; offset:12; nocase; reference:url,www.apple.com/itunes/; reference:url,www.multicastdns.org; classtype:misc-activity; sid:13900; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY XBOX avatar retrieval request"; flow:to_server,established; content:"/avatar/"; http_uri; content:"User-Agent|3A| Xbox Live Client/"; http_header; content:"Host|3A|avatar.xboxlive.com|0D 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:policy-violation; sid:15172; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"POLICY Suspicious .ru dns query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|ru|00|"; distance:0; pcre:"/[\x05-\x20][bcdfghjklmnpqrstvwxyz]{5,32}\x02ru\x00/i"; metadata:policy security-ips drop, service dns; classtype:trojan-activity; sid:15168; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY XBOX Netflix client active"; flow:to_server,established; content:"User-Agent|3A| NETFLIX360|0D 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:policy-violation; sid:15170; rev:3;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY Nintendo Wii SSL Server Hello"; flow:to_client,established; content:"Nintendo of America Inc"; fast_pattern:only; content:"noa.nintendo.com"; content:"|16|"; depth:1; content:"|02|"; depth:6; offset:5; metadata:policy balanced-ips drop, policy security-ips drop, service ssl; classtype:policy-violation; sid:15185; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"POLICY Suspicious .cn dns query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|cn|00|"; distance:0; pcre:"/[\x05-\x20][bcdfghjklmnpqrstvwxyz]{5,32}\x02cn\x00/i"; metadata:policy security-ips drop, service dns; classtype:trojan-activity; sid:15167; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY XBOX Marketplace http request"; flow:to_server,established; content:"/global"; http_uri; content:"/marketplace"; http_uri; content:"User-Agent|3A| Xbox Live Client/"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:policy-violation; sid:15171; rev:4;)
alert udp $HOME_NET any -> $EXTERNAL_NET 88 (msg:"POLICY XBOX Live Kerberos Authenthication Request"; flow:to_server; content:"Xbox Version="; fast_pattern:only; content:"PASSPORT.NET"; metadata:policy balanced-ips drop, policy security-ips drop, service kerberos; classtype:policy-violation; sid:15169; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"POLICY pdf file sent via email"; flow:to_server,established; content:"JVBERi0x"; flowbits:set,email.pdf; flowbits:noalert; metadata:service smtp; classtype:policy-violation; sid:15361; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY X-LINK2STATE CHUNK command attempt"; flow:to_server,established; content:"X-LINK2STATE"; fast_pattern:only; pcre:"/^X-LINK2STATE\s+CHUNK/smi"; reference:bugtraq,13118; reference:cve,2005-0560; reference:nessus,18024; reference:url,www.microsoft.com/technet/security/bulletin/MS05-021.mspx; classtype:protocol-command-decode; sid:3627; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Attempted download of a PDF with embedded Flash"; flow:to_client,established; flowbits:isset,http.pdf; content:"stream|0D 0A|FWS"; fast_pattern:only; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service http; reference:bugtraq,35759; reference:cve,2009-1862; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:15727; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Adobe PDF start-of-file alternate header obfuscation attempt"; flow:established,to_client; flowbits:isset,http.pdf; content:"%!PS-Adobe-"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:url,www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf; classtype:misc-activity; sid:16354; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY potentially executable file upload via FTP"; flow:established,to_server; content:"STOR"; depth:4; nocase; pcre:"/^STOR[^\r\n]+?\.(com|dll|exe|js|vbs)/smi"; metadata:service ftp; reference:url,tools.ietf.org/html/rfc959; classtype:policy-violation; sid:16363; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Adobe PDF alternate file magic obfuscation"; flow:established,to_client; flowbits:isset,http.pdf; content:"%COS-0.2"; depth:1032; content:"PDF-"; distance:0; metadata:policy security-ips drop, service http; reference:url,www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf; classtype:misc-activity; sid:16390; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Ultimate Packer for Executables/UPX v0.51-v0.61 packed file download attempt"; flow:to_client,established; flowbits:isset,http.exe; content:"`|E8 00 00 00 00|X|83 E8|=P|8D B8|"; content:"|FF|W"; within:2; distance:3; content:"|8A 06|F|88 07|G|EB EB 90 90 90 B8 01 00 00 00 01|"; within:17; distance:28; metadata:service http; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16434; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Ultimate Packer for Executables/UPX v2.90,v2.93-3.00 packed file download attempt"; flow:to_client,established; flowbits:isset,http.exe; content:"`|BE|"; content:"|8D BE|"; within:2; distance:4; pcre:"/^\x57(\x83\xCD\xFF)?\x89\xE5\x8D\x9C\x24.{4}\x31\xC0\x50\x39\xDC\x75\xFB\x46\x46\x53\x68.{4}\x57\x83\xC3\x04\x53\x68.{4}\x56\x83\xC3\x04\x53\x50\xC7\x03.{4}\x90\x90/R"; metadata:service http; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16436; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Ultimate Packer for Executables/UPX v0.62-v1.22 packed file download attempt"; flow:to_client,established; flowbits:isset,http.exe; content:"|8A 06|F|88 07|G|01 DB|u|07 8B 1E 83 EE FC 11 DB|"; pcre:"/^(\x72\xED\xB8\x01.{3}|\x8A\x07\x72\xEB\xB8\x01\x00\x00\x00)\x01\xDB\x75\x07\x8B\x1E\x83\xEE\xFC\x11\xDB\x11\xC0\x01\xDB[\x73\x77].{3}\x8B\x1E\x83\xEE\xFC/R"; metadata:service http; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16435; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,http.pdf; content:"obj"; nocase; content:"<<"; within:4; content:"/Launch"; within:100; fast_pattern; content:"/F"; pcre:"/\/F[^\/>]+\.(exe|dll|com|swf)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:16523; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Chat web client connection"; flow:established,to_server; content:"/talkgadget/popout"; fast_pattern; nocase; http_uri; classtype:policy-violation; sid:12303; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Crystal reports download request"; flow:to_server,established; content:".rpt"; fast_pattern; nocase; http_uri; flowbits:set, rpt.download; flowbits:noalert; classtype:policy-violation; sid:12455; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop initial install  - installer request"; flow:to_server,established; content:"/installer?"; fast_pattern; nocase; http_uri; content:"action=install"; http_uri; content:"version="; http_uri; content:"id="; http_uri; content:"brand=GGLD"; http_uri; content:"hl="; http_uri; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7859; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of executable content"; flow:to_client,established; content:"application/octet-stream"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/octet-stream/smiH"; content:"MZ"; depth:2; file_data; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:11192; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Yahoo Messenger web client connection"; flow:established,to_server; content:"/BootStrapper.swf"; fast_pattern; nocase; http_uri; classtype:policy-violation; sid:12305; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Habbo chat client item information download"; flow:to_server,established; content:"/gamedata/external?id=external_"; fast_pattern; nocase; http_uri; metadata:policy security-ips drop; reference:url,www.habbo.com; classtype:policy-violation; sid:13862; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"POLICY Namazu incoming namazu.cgi access"; flow:to_server,established; content:"/namazu.cgi?query="; fast_pattern; nocase; http_uri; content:"&submit=Search"; http_uri; reference:url,www.namazu.org/doc/manual.html; classtype:web-application-activity; sid:5706; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY AOL Instant Messenger web client connection"; flow:established,to_server; content:"HostCheck.aspx"; fast_pattern; nocase; http_uri; content:"aimexpress.aol.com"; http_uri; pcre:"/Cookie\x3A.*s_sq=aolsnssignin/si"; classtype:policy-violation; sid:12304; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY  Microsoft Messenger web client connection"; flow:established,to_server; content:"mainui.aspx"; fast_pattern; nocase; http_uri; content:"webmessenger"; nocase; classtype:policy-violation; sid:12306; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop search query"; flow:to_server,established; content:"/complete/search?"; fast_pattern; nocase; http_uri; content:"q="; http_uri; content:"output=desktop"; http_uri; content:"sourceid=gd"; http_uri; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7860; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Namazu outbound namazu.cgi access"; flow:to_server,established; content:"/namazu.cgi?query="; fast_pattern; nocase; http_uri; content:"&submit=Search"; http_uri; reference:url,www.namazu.org/doc/manual.html; classtype:web-application-activity; sid:5707; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY kontiki runtime detection"; flow:to_server,established; content:"User-Agent|3A| Kontiki Client"; fast_pattern; nocase; http_header; metadata:policy security-ips alert, service http; reference:url,www.extremetech.com/article2/0,3973,365073,00.asp; classtype:policy-violation; sid:5797; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Gizmo VOIP client start-up version check"; flow:established,to_server; content:"/dll/app?"; fast_pattern; nocase; http_uri; content:"class=DLL"; nocase; http_uri; content:"ApplicationID"; nocase; http_uri; content:"Gizmo"; nocase; http_uri; reference:url,www.gizmoproject.com; classtype:policy-violation; sid:6406; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop initial install - firstuse request"; flow:to_server,established; content:"/firstuse?"; fast_pattern; nocase; http_uri; content:"version="; http_uri; content:"id="; http_uri; content:"brand=GGLD"; http_uri; content:"hl="; http_uri; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7858; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of executable content - x-header"; flow:to_client,established; content:"application/x-msdos-program"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/x-msdos-program/smiH"; pcre:"/(\r?\n){2}MZ/sm"; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:16313; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY download of .dat file"; flow:established,to_server; content:".dat"; nocase; http_uri; pcre:"/\.dat(\x3F|$)/Ui"; metadata:service http; classtype:misc-activity; sid:16630; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY download of .bin file"; flow:established,to_server; content:".bin"; nocase; http_uri; pcre:"/\.bin(\x3F|$)/Ui"; metadata:service http; classtype:misc-activity; sid:16629; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY File URI scheme"; flow:established,to_client; content:"file|3A 2F 2F|"; nocase; reference:url,tools.ietf.org/html/rfc1630; reference:url,tools.ietf.org/html/rfc1738; classtype:policy-violation; sid:16642; rev:1;)
# alert tcp $HOME_NET 22 -> $EXTERNAL_NET any (msg:"POLICY Tandberg VCS SSH default key"; flow:established,to_client; content:"|BF E2 52 B5 9A 23 8F E9 FE 10 49 C4 36 BD 31 85 D6 7E 41 C9 15 42 F1 01|"; metadata:policy security-ips drop, service ssh; reference:cve,2009-4510; reference:url,www.tandberg.com/video-conferencing-network-infrastructure/video-communication-server.jsp; reference:url,www.vsecurity.com/resources/advisory/20100409-1/; classtype:misc-activity; sid:16680; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 17185 (msg:"POLICY VxWorks remote debugging agent login attempt"; content:"|00 00 00 00 00 00 00 02 55 55 55 55 00 00 00 01 00 00 00 01|"; depth:20; offset:4; metadata:policy security-ips drop; reference:url,blog.metasploit.com/2010/08/vxworks-vulnerabilities.html; reference:url,www.kb.cert.org/vuls/id/362332; classtype:protocol-command-decode; sid:17110; rev:1;)
# alert tcp any [139,445] -> $HOME_NET any (msg:"POLICY Portable Executable binary file transfer over SMB"; flow:to_client,established; content:"|FF|SMB"; depth:4; offset:4; byte_jump:1,28,relative,multiplier 2; content:"MZ|90 00|"; within:4; distance:2; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; classtype:policy-violation; sid:17210; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY base64-encoded uri data object found"; flow:to_client,established; content:"base64"; pcre:"/<\s*object[^>]*?data\s*\x3A[^,>]*?base64/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,tools.ietf.org/html/rfc2397; classtype:policy-violation; sid:17291; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Media Player compressed skin download - .wmd"; flow:established,to_server; content:".wmd"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25305; reference:cve,2007-3037; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-047.mspx; classtype:policy-violation; sid:17546; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of Windows .lnk file that executes cmd.exe detected"; flow:to_client,established; flowbits:isset,http.lnk; content:"WINDOWS|5C|system32|5C|cmd|2E|exe"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,15069; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-049.mspx; classtype:attempted-user; sid:17442; rev:1;)
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 (msg:"POLICY Possible Microsoft telnet NTLM reflection attempt"; flow:established, to_server; content:"|FF FA 25 00 0F|"; depth:5; rawbytes; content:"NTLMSSP"; within:7; distance:10; fast_pattern; rawbytes; metadata:policy balanced-ips drop, policy security-ips drop, service telnet; reference:cve,2000-0834; reference:cve,2009-1930; reference:url,secunia.com/advisories/36222/; classtype:attempted-admin; sid:17627; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 6504 (msg:"POLICY CA BightStor ARCserver Backup possible insecure method attempt"; flow:established, to_server; dce_iface:506b1890-14c8-11d1-bbc3-00805fa6962e; dce_opnum:383-396; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:cve,2007-5328; reference:url,secunia.com/advisories/27192/; classtype:attempted-user; sid:17577; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded JavaScript"; flow:established,to_client; content:"obj"; nocase; content:"<<"; within:4; content:"/JS "; distance:0; fast_pattern; nocase; pcre:"/obj\s{0,2}<<[^>]*?\x2fS[^>]*?\x2fJS\s+/smi"; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:17668; rev:1;)
